# S04 ‚Äì eda_cli: HTTP-—Å–µ—Ä–≤–∏—Å –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ (FastAPI)

–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞ `eda_cli` –∏–∑ –°–µ–º–∏–Ω–∞—Ä–∞ 03.  
–ö —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É CLI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –¥–ª—è EDA –¥–æ–±–∞–≤–ª–µ–Ω HTTP-—Å–µ—Ä–≤–∏—Å –Ω–∞ **FastAPI** —Å —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏ `/health`, `/quality`, `/quality-from-csv` –∏ –Ω–æ–≤—ã–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–º `/quality-flags-from-csv` (HW03/HW04).

---

## üîó –°–≤—è–∑—å —Å S03

–ü—Ä–æ–µ–∫—Ç –≤ S04 –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Ç–æ–º –∂–µ –ø–∞–∫–µ—Ç–µ `eda_cli`:

- —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `src/eda_cli/` –∏ CLI-–∫–æ–º–∞–Ω–¥–∞ `eda-cli`;  
- –¥–æ–±–∞–≤–ª–µ–Ω –º–æ–¥—É–ª—å `api.py` —Å FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º;  
- –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã `fastapi` –∏ `uvicorn[standard]`.  

---

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Python 3.11+**  
- **uv** —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ —Å–∏—Å—Ç–µ–º—É  
- –ë—Ä–∞—É–∑–µ—Ä (–¥–ª—è Swagger UI `/docs`) –∏–ª–∏ –ª—é–±–æ–π HTTP-–∫–ª–∏–µ–Ω—Ç (curl, Postman, Hoppscotch)

---

## üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
uv sync
````

–ö–æ–º–∞–Ω–¥–∞:

* —Å–æ–∑–¥–∞—Å—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ `.venv`;
* —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ `pyproject.toml` (–≤–∫–ª—é—á–∞—è FastAPI –∏ Uvicorn);
* —É—Å—Ç–∞–Ω–æ–≤–∏—Ç —Å–∞–º –ø—Ä–æ–µ–∫—Ç `eda-cli` –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–µ.

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ CLI

CLI –æ—Å—Ç–∞—ë—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º:

```bash
uv run eda-cli overview data/example.csv
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

* `--sep` ‚Äî —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `,`)
* `--encoding` ‚Äî –∫–æ–¥–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `utf-8`)

–ü–æ–ª–Ω—ã–π EDA-–æ—Ç—á—ë—Ç:

```bash
uv run eda-cli report data/example.csv --out-dir reports
```

–í –∫–∞—Ç–∞–ª–æ–≥–µ `reports/` –ø–æ—è–≤—è—Ç—Å—è:

* `report.md` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –æ—Ç—á—ë—Ç
* `summary.csv` ‚Äî —Ç–∞–±–ª–∏—Ü–∞ –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º
* `missing.csv` ‚Äî –ø—Ä–æ–ø—É—Å–∫–∏ –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º
* `correlation.csv` ‚Äî –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
* `top_categories/*.csv` ‚Äî top-k –∫–∞—Ç–µ–≥–æ—Ä–∏–π
* `hist_*.png` ‚Äî –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —á–∏—Å–ª–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
* `missing_matrix.png` ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤
* `correlation_heatmap.png` ‚Äî —Ç–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π

---

## üîß –ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥—ã `report` (HW03)

| –ü–∞—Ä–∞–º–µ—Ç—Ä              | –û–ø–∏—Å–∞–Ω–∏–µ                                                               |
| --------------------- | ---------------------------------------------------------------------- |
| `--title`             | –ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ—Ç—á—ë—Ç–∞ –≤ –Ω–∞—á–∞–ª–µ `report.md`                                  |
| `--max-hist-columns`  | –°–∫–æ–ª—å–∫–æ —á–∏—Å–ª–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ –≤–∫–ª—é—á–∞—Ç—å –≤ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã                        |
| `--top-k-categories`  | –°–∫–æ–ª—å–∫–æ top-–∑–Ω–∞—á–µ–Ω–∏–π –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤           |
| `--min-missing-share` | –ü–æ—Ä–æ–≥ –¥–æ–ª–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤: –∫–æ–ª–æ–Ω–∫–∏ –≤—ã—à–µ –ø–æ—Ä–æ–≥–∞ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ |

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

```bash
uv run pytest -q
```

---

# üåê HTTP-—Å–µ—Ä–≤–∏—Å (FastAPI)

HTTP-—Å–µ—Ä–≤–∏—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –º–æ–¥—É–ª–µ `eda_cli.api`.

### üîπ –ó–∞–ø—É—Å–∫ Uvicorn

```bash
uv run uvicorn eda_cli.api:app --reload --port 8000
```

* `eda_cli.api:app` ‚Äî –ø—É—Ç—å –¥–æ –æ–±—ä–µ–∫—Ç–∞ FastAPI app
* `--reload` ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞
* `--port 8000` ‚Äî –ø–æ—Ä—Ç —Å–µ—Ä–≤–∏—Å–∞ (–º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å)

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: **[http://127.0.0.1:8000](http://127.0.0.1:8000)**

---

## üìÑ –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å–µ—Ä–≤–∏—Å–∞

### 1Ô∏è‚É£ GET `/health` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

**–ü—Ä–æ—Å—Ç–µ–π—à–∏–π health-check**

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

```bash
curl http://127.0.0.1:8000/health
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ 200 OK:**

```json
{
  "status": "ok",
  "service": "dataset-quality",
  "version": "0.2.0"
}
```

---

### 2Ô∏è‚É£ GET `/docs` ‚Äî Swagger UI

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API:
**[http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)**

–ß–µ—Ä–µ–∑ `/docs` –º–æ–∂–Ω–æ:

* –≤—ã–∑—ã–≤–∞—Ç—å `GET /health`
* –≤—ã–∑—ã–≤–∞—Ç—å `POST /quality`
* –≤—ã–∑—ã–≤–∞—Ç—å `POST /quality-from-csv`
* –≤—ã–∑—ã–≤–∞—Ç—å `POST /quality-flags-from-csv`

---

### 3Ô∏è‚É£ POST `/quality` ‚Äî –∞–Ω–∞–ª–∏–∑ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–≠–Ω–¥–ø–æ–∏–Ω—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç JSON —Å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞:

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

```bash
curl -X POST "http://127.0.0.1:8000/quality" \
  -H "Content-Type: application/json" \
  -d '{"n_rows": 10000, "n_cols": 12, "max_missing_share": 0.15, "numeric_cols": 8, "categorical_cols": 4}'
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ 200 OK:**

```json
{
  "ok_for_model": true,
  "quality_score": 0.8,
  "message": "–î–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –º–æ–¥–µ–ª—å –º–æ–∂–Ω–æ –æ–±—É—á–∞—Ç—å (–ø–æ —Ç–µ–∫—É—â–∏–º —ç–≤—Ä–∏—Å—Ç–∏–∫–∞–º).",
  "latency_ms": 3.2,
  "flags": {
    "too_few_rows": false,
    "too_many_columns": false,
    "too_many_missing": false,
    "no_numeric_columns": false,
    "no_categorical_columns": false
  },
  "dataset_shape": {
    "n_rows": 10000,
    "n_cols": 12
  }
}
```

---

### 4Ô∏è‚É£ POST `/quality-from-csv` ‚Äî –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ CSV

–≠–Ω–¥–ø–æ–∏–Ω—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç CSV-—Ñ–∞–π–ª –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ü–µ–Ω–∫—É –∫–∞—á–µ—Å—Ç–≤–∞:

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

```bash
curl -X POST "http://127.0.0.1:8000/quality-from-csv" \
  -F "file=@data/example.csv"
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**

```json
{
  "ok_for_model": true,
  "quality_score": 0.75,
  "flags": {
    "too_few_rows": false,
    "too_many_columns": false,
    "too_many_missing": true,
    "no_numeric_columns": false,
    "no_categorical_columns": false
  },
  "dataset_shape": {
    "n_rows": 5234,
    "n_cols": 18
  },
  "latency_ms": 5.8
}
```

---

### 5Ô∏è‚É£ üÜï POST `/quality-flags-from-csv` ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ–ª–∞–≥–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (HW03/HW04)

–≠–Ω–¥–ø–æ–∏–Ω—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç CSV-—Ñ–∞–π–ª –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–≤—Å–µ –±–∞–∑–æ–≤—ã–µ —Ñ–ª–∞–≥–∏ + –Ω–æ–≤—ã–µ HW03-—Ñ–ª–∞–≥–∏**:

* `has_high_ratio_of_unique_values`
* `has_outliers`
* `has_mixed_types`
* `has_imbalanced_categoricals`
* `has_many_repeated_rows`

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

```bash
curl -X POST "http://127.0.0.1:8000/quality-flags-from-csv" \
  -F "file=@data/example.csv"
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**

```json
{
  "flags": {
    "too_few_rows": false,
    "too_many_columns": false,
    "too_many_missing": false,
    "no_numeric_columns": false,
    "no_categorical_columns": false,

    "has_high_ratio_of_unique_values": true,
    "has_outliers": true,
    "has_mixed_types": false,
    "has_imbalanced_categoricals": false,
    "has_many_repeated_rows": false
  },
  "dataset_shape": {
    "n_rows": 5234,
    "n_cols": 18
  },
  "latency_ms": 6.91
}
```

**–û–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ–ª–∞–≥–æ–≤ HW03:**

| –§–ª–∞–≥                              | –û–ø–∏—Å–∞–Ω–∏–µ                               |
| --------------------------------- | -------------------------------------- |
| `has_high_ratio_of_unique_values` | –í –∫–æ–ª–æ–Ω–∫–µ >80% —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π     |
| `has_outliers`                    | >5% –≤—ã–±—Ä–æ—Å–æ–≤ –ø–æ –ø—Ä–∞–≤–∏–ª—É 1.5√óIQR        |
| `has_mixed_types`                 | –ö–æ–ª–æ–Ω–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ |
| `has_imbalanced_categoricals`     | –ö–∞—Ç–µ–≥–æ—Ä–∏—è >90% –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫              |
| `has_many_repeated_rows`          | >10% –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å—Ç—Ä–æ–∫               |

---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (—É–ø—Ä–æ—â—ë–Ω–Ω–æ)

```
S04/
  eda-cli/
    pyproject.toml
    README.md
    src/
      eda_cli/
        __init__.py
        core.py       # EDA-–ª–æ–≥–∏–∫–∞, —ç–≤—Ä–∏—Å—Ç–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
        viz.py        # –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
        cli.py        # CLI (overview/report)
        api.py        # HTTP-—Å–µ—Ä–≤–∏—Å (FastAPI)
    tests/
      test_core.py   # —Ç–µ—Å—Ç—ã —è–¥—Ä–∞
    data/
      example.csv     # —É—á–µ–±–Ω—ã–π CSV –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
```